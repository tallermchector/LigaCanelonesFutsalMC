// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Team {
  id      Int      @id @default(autoincrement())
  name    String
  logoUrl String?
  players Player[]
  matchesA Match[] @relation("TeamA")
  matchesB Match[] @relation("TeamB")
}

model Player {
  id       Int     @id @default(autoincrement())
  name     String
  number   Int
  position String
  team     Team    @relation(fields: [teamId], references: [id])
  teamId   Int
  events   GameEvent[]
}

model Match {
  id              Int      @id @default(autoincrement())
  scheduledTime   DateTime
  status          String   @default("SCHEDULED")
  teamA           Team     @relation("TeamA", fields: [teamAId], references: [id])
  teamAId         Int
  teamB           Team     @relation("TeamB", fields: [teamBId], references: [id])
  teamBId         Int
  scoreA          Int      @default(0)
  scoreB          Int      @default(0)
  foulsA          Int      @default(0)
  foulsB          Int      @default(0)
  timeoutsA       Int      @default(1)
  timeoutsB       Int      @default(1)
  period          Int      @default(1)
  time            Int      @default(1200) // 20 minutes in seconds
  isRunning       Boolean  @default(false)
  events          GameEvent[]
  round           Int      @default(1)
  activePlayersA  Int[]
  activePlayersB  Int[]
}

model GameEvent {
  id            String  @id @default(cuid())
  match         Match   @relation(fields: [matchId], references: [id])
  matchId       Int
  type          String
  teamId        String?
  playerId      Int?
  player        Player? @relation(fields: [playerId], references: [id])
  playerName    String?
  playerInId    Int?
  playerInName  String?
  teamName      String?
  timestamp     Int
}
